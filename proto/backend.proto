syntax = "proto3";
package ankiaddon.backend;

import "generic.proto";

service BackendService {
  rpc GetTatoebaLanguages(generic.Empty) returns (GetTatoebaLanguagesResponse);
  rpc DownloadTatoebaSentences(DownloadTatoebaSentencesRequest) returns (generic.Empty);
  rpc GetTatoebaDownloadProgress(generic.Empty) returns (TatoebaDownloadProgress);
  rpc GetDefaultFillFields(GetDefaultFillFieldsRequest) returns (GetDefaultFillFieldsResponse);
  rpc GetProvidersForLanguage(GetProvidersForLanguageRequest) returns (GetProvidersForLanguageResponse);
  rpc FillInSentences(FillInSentencesRequest) returns (generic.Empty);
  rpc GetLanguages(generic.Empty) returns (GetLanguagesResponse);
  rpc GetSentences(GetSentencesRequest) returns (GetSentencesResponse);
}


message GetTatoebaLanguagesResponse {
  repeated Language languages = 1;
}

message Language {
  string code = 1;
  string name = 2;
}

message Provider {
  string code = 1;
  string name = 2;
}

message DownloadTatoebaSentencesRequest {
  string language = 1;
}

message TatoebaDownloadProgress {
  float progress = 1;
  string message = 2;
  bool is_error = 3;
  bool finished = 4;
}

message GetDefaultFillFieldsRequest {
  repeated int64 nids = 1;
}

message GetDefaultFillFieldsResponse {
  string language = 1;
  repeated string providers = 2;
  string word_field = 3;
  string sentences_field = 4;
  int64 number_of_sentences = 5;
  repeated Language languages = 6;
  repeated Provider language_providers = 7;
  repeated string fields = 8;
}

message GetProvidersForLanguageRequest {
  string language = 1;
}

message GetProvidersForLanguageResponse {
  repeated Provider providers = 1;
}

message FillInSentencesRequest {
  string language = 1;
  repeated string providers = 2;
  string word_field = 3;
  string sentences_field = 4;
  int64 number_of_sentences = 5;
  repeated int64 nids = 6;
}

message GetLanguagesResponse {
  repeated Language languages = 1;
}

message GetSentencesRequest {
  string word = 1;
  string language = 2;
  repeated string providers = 3;
}

message GetSentencesResponse {
  repeated Sentence sentences = 1;
}

message Sentence {
  string text = 1;
  string provider = 2;
  string url = 3;
}
